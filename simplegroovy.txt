#!/usr/bin/env groovy

// Jenkinsfile (Declarative Pipeline)

pipeline {
  agent any

  environment {
        AZURE_SUBSCRIPTION_ID='783ed336-9aff-4c71-b6c0-8efb879033a5'
        AZURE_TENANT_ID='cc0361ca-deca-4db3-b421-ee1ca53c7f00'
    }

  stages {
    stage('Stage 1') {
      steps {
        echo 'Hello world!'
        withCredentials([usernamePassword(credentialsId: 'thejenkinsID', passwordVariable: 'AZURE_CLIENT_SECRET', usernameVariable: 'AZURE_CLIENT_ID')]) {
        sh 'az login --service-principal -u $AZURE_CLIENT_ID -p $AZURE_CLIENT_SECRET -t $AZURE_TENANT_ID'
        sh 'az account set -s $AZURE_SUBSCRIPTION_ID'
      }
    }

  }
}
}